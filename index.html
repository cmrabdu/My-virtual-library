<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ma BibliothÃ¨que Intelligente</title>
    <meta name="description" content="GÃ©rez votre bibliothÃ¨que personnelle avec IA">
    <!-- PWA Meta tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- App Container -->
    <div class="app-container">
        
        <!-- PAGE 1: ACCUEIL -->
        <div class="page" id="page-home" style="display: block;">
            <div class="page-header">
                <h1>ğŸ‘‹ Bonjour <span id="homeUserName">Lecteur</span> !</h1>
                <p class="welcome-subtitle">Bienvenue dans votre bibliothÃ¨que personnelle</p>
            </div>

            <!-- Statistiques rapides -->
            <div class="stats-quick">
                <div class="stat-card stat-card-primary">
                    <div class="stat-icon">ğŸ“š</div>
                    <div class="stat-content">
                        <div class="stat-number" id="totalBooks">0</div>
                        <div class="stat-label">Livres</div>
                    </div>
                </div>
                <div class="stat-card stat-card-success">
                    <div class="stat-icon">âœ…</div>
                    <div class="stat-content">
                        <div class="stat-number" id="readBooks">0</div>
                        <div class="stat-label">Lus</div>
                    </div>
                </div>
                <div class="stat-card stat-card-info">
                    <div class="stat-icon">ğŸ“–</div>
                    <div class="stat-content">
                        <div class="stat-number" id="currentlyReading">0</div>
                        <div class="stat-label">En cours</div>
                    </div>
                </div>
            </div>

            <!-- Livres en cours -->
            <div class="section">
                <div class="section-header">
                    <h2>ğŸ“– En cours de lecture</h2>
                </div>
                <div id="currentReadingList" class="books-grid"></div>
            </div>

            <!-- Top du mois -->
            <div class="section" id="topMonthSection" style="display: none;">
                <div class="section-header">
                    <h2>ğŸ”¥ Ton Top du mois</h2>
                </div>
                <div id="topMonthList" class="books-grid"></div>
            </div>

            <!-- Recommandations -->
            <div class="section" id="recommendationsSection" style="display: none;">
                <div class="section-header">
                    <h2>ğŸ’¡ Recommandations pour toi</h2>
                </div>
                <p class="section-subtitle">ğŸ¯ BasÃ©es sur tes lectures prÃ©fÃ©rÃ©es</p>
                <div id="recommendationsList" class="books-grid"></div>
            </div>

            <!-- Derniers ajouts -->
            <div class="section">
                <h2>ğŸ†• Derniers ajouts</h2>
                <div id="recentBooksList" class="books-grid"></div>
            </div>
        </div>

        <!-- PAGE 2: BIBLIOTHÃˆQUE -->
        <div class="page" id="page-library" style="display: none;">
            <div class="page-header">
                <h1>ğŸ“š Ma BibliothÃ¨que</h1>
                <p class="library-subtitle">Mon espace de connaissances</p>
            </div>

            <!-- Tabs BibliothÃ¨que -->
            <div class="library-tabs">
                <button class="library-tab active" data-tab="books">
                    <span class="tab-icon">ğŸ“–</span>
                    <span class="tab-label">Mes Livres</span>
                </button>
                <button class="library-tab" data-tab="stats">
                    <span class="tab-icon">ğŸ“Š</span>
                    <span class="tab-label">Statistiques</span>
                </button>
                <button class="library-tab" data-tab="insights">
                    <span class="tab-icon">ğŸ§ </span>
                    <span class="tab-label">Connaissances</span>
                </button>
            </div>

            <!-- TAB: MES LIVRES -->
            <div class="library-tab-content" id="tab-books" style="display: block;">
                <p class="library-count" id="libraryCount">0 livre</p>

                <!-- Statistiques rapides -->
                <div class="library-quick-stats">
                    <div class="quick-stat-card">
                        <div class="stat-icon">ğŸ“–</div>
                        <div class="stat-info">
                            <span class="stat-value" id="toReadCount">0</span>
                            <span class="stat-label">Ã€ lire</span>
                        </div>
                    </div>
                    <div class="quick-stat-card">
                        <div class="stat-icon">ğŸ“š</div>
                        <div class="stat-info">
                            <span class="stat-value" id="readingCount">0</span>
                            <span class="stat-label">En cours</span>
                        </div>
                    </div>
                    <div class="quick-stat-card">
                        <div class="stat-icon">âœ…</div>
                        <div class="stat-info">
                            <span class="stat-value" id="readCount">0</span>
                            <span class="stat-label">TerminÃ©s</span>
                        </div>
                    </div>
                </div>

                <!-- Filtres -->
                <div class="library-filters">
                    <div class="search-input-wrapper">
                        <span class="search-icon">ğŸ”</span>
                        <input type="text" id="searchBooks" placeholder="Rechercher par titre ou auteur...">
                    </div>
                    <div class="status-filter-chips">
                        <button class="status-chip active" data-status="">ğŸ“š Tous</button>
                        <button class="status-chip" data-status="to-read">ğŸ“– Ã€ lire</button>
                        <button class="status-chip" data-status="reading">ğŸ“• En cours</button>
                        <button class="status-chip" data-status="read">âœ… Lus</button>
                    </div>
                </div>

                <div id="booksContainer">
                    <div class="loading" id="loadingBooks">
                        <div class="spinner"></div>
                        Chargement...
                    </div>
                    <div id="booksList" class="books-grid"></div>
                    <div id="emptyState" class="empty-state" style="display: none;">
                        <div class="empty-icon">ğŸ“š</div>
                        <h3>BibliothÃ¨que vide</h3>
                        <p>Commencez Ã  construire votre collection !</p>
                        <button class="btn btn-primary" onclick="navigateTo('add')">â• Ajouter un livre</button>
                    </div>
                </div>
            </div>

            <!-- TAB: STATISTIQUES -->
            <div class="library-tab-content" id="tab-stats" style="display: none;">
                <div class="stats-overview">
                    <div class="stat-card stat-card-outline">
                        <div class="stat-icon-large">ğŸ“š</div>
                        <div class="stat-number" id="totalBooks2">0</div>
                        <div class="stat-label">Total</div>
                    </div>
                    <div class="stat-card stat-card-outline">
                        <div class="stat-icon-large">ğŸ“–</div>
                        <div class="stat-number" id="toReadBooks">0</div>
                        <div class="stat-label">Ã€ lire</div>
                    </div>
                    <div class="stat-card stat-card-outline">
                        <div class="stat-icon-large">â­</div>
                        <div class="stat-number" id="averageRating">-</div>
                        <div class="stat-label">Note moyenne</div>
                    </div>
                </div>

                <div class="charts-container">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>ğŸ“š RÃ©partition des livres</h3>
                        </div>
                        <canvas id="statusChart" width="300" height="300"></canvas>
                    </div>
                    
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>â­ Distribution des notes</h3>
                        </div>
                        <canvas id="ratingChart" width="300" height="200"></canvas>
                    </div>
                    
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>ğŸ“ˆ Ã‰volution mensuelle</h3>
                        </div>
                        <canvas id="evolutionChart" width="300" height="200"></canvas>
                    </div>
                    
                    <div class="chart-card chart-card-goal">
                        <div class="chart-header">
                            <h3>ğŸ¯ Objectif annuel</h3>
                        </div>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" id="yearlyProgress"></div>
                            </div>
                            <div class="progress-text" id="progressText">0 / 24 livres</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB: CONNAISSANCES (IA) -->
            <div class="library-tab-content" id="tab-insights" style="display: none;">
                <div class="insights-placeholder">
                    <div class="coming-soon-card">
                        <div class="coming-soon-icon">ğŸ§ </div>
                        <h2>Carte Mentale des Connaissances</h2>
                        <p>Visualisez les connexions entre vos livres, dÃ©couvrez vos patterns de lecture et explorez votre jardin de connaissances de maniÃ¨re interactive.</p>
                        <div class="features-preview">
                            <div class="feature-item">
                                <span class="feature-icon">ğŸ—ºï¸</span>
                                <span>Graph interactif des genres et thÃ¨mes</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">ğŸ”—</span>
                                <span>Connexions entre auteurs et Å“uvres</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">ğŸ’¡</span>
                                <span>Insights IA sur vos lectures</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">ğŸ“ˆ</span>
                                <span>Ã‰volution de vos intÃ©rÃªts</span>
                            </div>
                        </div>
                        <p class="coming-soon-note">ğŸš€ FonctionnalitÃ© en dÃ©veloppement - BientÃ´t disponible</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- PAGE 3: RECHERCHER -->
                </div>
            </div>
        </div>

        <!-- PAGE 3: AJOUTER -->
        <div class="page" id="page-add" style="display: none;">
            <div class="page-header">
                <h1>â• Ajouter un livre</h1>
            </div>

            <form id="bookForm">
                <!-- Recherche ISBN -->
                <div class="isbn-search-group">
                    <label for="isbn">ğŸ“– Recherche rapide par ISBN</label>
                    <div class="isbn-input-group">
                        <input type="text" id="isbn" placeholder="Entrez l'ISBN du livre (ex: 9782072762093)">
                        <div class="isbn-buttons-group">
                            <button type="button" id="scanBtn" class="btn btn-scan">
                                ğŸ“· Scanner
                            </button>
                            <button type="button" id="searchBtn" class="btn btn-secondary">
                                ğŸ” Rechercher
                            </button>
                        </div>
                    </div>
                    <input type="file" id="cameraInput" accept="image/*" capture="environment" style="display: none;">
                </div>

                <div class="form-divider">
                    <span>ou remplir manuellement</span>
                </div>

                <!-- Informations principales -->
                <div class="form-group">
                    <label for="title">Titre *</label>
                    <input type="text" id="title" required placeholder="Le titre du livre">
                </div>

                <div class="form-group">
                    <label for="author">Auteur *</label>
                    <input type="text" id="author" required placeholder="Nom de l'auteur">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="pages">Nombre de pages</label>
                        <input type="number" id="pages" placeholder="300">
                    </div>
                </div>

                <div class="form-group">
                    <label>Statut</label>
                    <div class="status-selector">
                        <button type="button" class="status-option" data-status="to-read">
                            <span class="status-icon">ğŸ“š</span>
                            <span class="status-label">Ã€ lire</span>
                        </button>
                        <button type="button" class="status-option active" data-status="reading">
                            <span class="status-icon">ğŸ“–</span>
                            <span class="status-label">En cours</span>
                        </button>
                        <button type="button" class="status-option" data-status="read">
                            <span class="status-icon">âœ…</span>
                            <span class="status-label">Lu</span>
                        </button>
                    </div>
                    <input type="hidden" id="status" value="reading" required>
                </div>

                <div class="form-group" id="ratingGroup" style="display: none;">
                    <label for="rating">Note</label>
                    <div class="star-rating" id="starRating">
                        <span class="star" data-rating="1">â˜†</span>
                        <span class="star" data-rating="2">â˜†</span>
                        <span class="star" data-rating="3">â˜†</span>
                        <span class="star" data-rating="4">â˜†</span>
                        <span class="star" data-rating="5">â˜†</span>
                    </div>
                    <input type="hidden" id="rating" value="0">
                </div>

                <!-- DÃ©tails optionnels (visible uniquement si statut = "lu") -->
                <div class="form-group" id="summaryGroup" style="display: none;">
                    <label for="summary">RÃ©sumÃ© (optionnel)</label>
                    <textarea id="summary" rows="3" placeholder="Un bref rÃ©sumÃ© du livre..."></textarea>
                </div>

                <div class="form-group" id="learningsGroup" style="display: none;">
                    <label for="learnings">Apprentissages (optionnel)</label>
                    <textarea id="learnings" rows="3" placeholder="Ce que vous avez appris de ce livre..."></textarea>
                </div>

                <button type="submit" class="btn btn-primary btn-add-book">
                    âœ… Ajouter Ã  ma bibliothÃ¨que
                </button>
            </form>
        </div>

        <!-- PAGE 4: RECHERCHER -->
        <div class="page" id="page-search" style="display: none;">
            <div class="page-header">
                <h1>ğŸ” Rechercher</h1>
            </div>

            <div class="search-section">
                <div class="search-bar-container">
                    <input type="text" id="globalSearchInput" placeholder="ğŸ” Rechercher un livre, un auteur..." class="search-input-large">
                    <button id="globalSearchBtn" class="btn btn-primary">ğŸ” Rechercher</button>
                </div>

                <div class="search-filters">
                    <button class="filter-chip active" data-filter="all">ğŸŒ Tout</button>
                    <button class="filter-chip" data-filter="books">ğŸ“š Livres</button>
                    <button class="filter-chip" data-filter="authors">âœï¸ Auteurs</button>
                </div>

                <div id="searchResults" class="search-results">
                    <div class="search-placeholder">
                        <div class="search-icon">ğŸ”</div>
                        <h3>DÃ©couvrez de nouveaux livres</h3>
                        <p>Recherchez par titre, auteur ou ISBN</p>
                        <div class="search-suggestions">
                            <p style="color: #64748b; margin-top: 20px; font-size: 14px;">ğŸ”¥ Suggestions:</p>
                            <div class="suggestion-chips">
                                <button class="suggestion-chip" onclick="quickSearch('science fiction')">Science Fiction</button>
                                <button class="suggestion-chip" onclick="quickSearch('philosophie')">Philosophie</button>
                                <button class="suggestion-chip" onclick="quickSearch('business')">Business</button>
                                <button class="suggestion-chip" onclick="quickSearch('histoire')">Histoire</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PAGE 5: PROFIL (Vue Publique) -->
        <div class="page" id="page-profile" style="display: none;">
            <div class="page-header profile-header">
                <h1>ğŸ‘¤ Mon Profil</h1>
                <button class="btn-settings" id="openSettingsBtn">
                    <span class="settings-icon">âš™ï¸</span>
                    <span class="settings-text">ParamÃ¨tres</span>
                </button>
            </div>

            <!-- Carte Profil Public -->
            <div class="public-profile">
                <div class="profile-card-public">
                    <div class="profile-avatar-large">
                        <div class="avatar-circle-large" id="userAvatarDisplay">ğŸ“š</div>
                    </div>
                    <h2 class="profile-username" id="userNamePublic">@lecteur</h2>
                    <p class="profile-bio-public" id="userBioPublic">ğŸ“ Amateur de livres</p>
                    
                    <div class="profile-stats-public">
                        <div class="stat-item-public">
                            <div class="stat-number-public" id="publicTotalBooks">0</div>
                            <div class="stat-label-public">Livres</div>
                        </div>
                        <div class="stat-divider"></div>
                        <div class="stat-item-public">
                            <div class="stat-number-public" id="publicReadBooks">0</div>
                            <div class="stat-label-public">Lus</div>
                        </div>
                        <div class="stat-divider"></div>
                        <div class="stat-item-public">
                            <div class="stat-number-public" id="publicPages">0</div>
                            <div class="stat-label-public">Pages</div>
                        </div>
                    </div>
                </div>

                <!-- Meilleurs Livres (5 Ã©toiles) -->
                <div class="profile-section-public">
                    <h3 class="section-title-public">ğŸ† Meilleurs livres</h3>
                    <div class="favorite-books-grid" id="favoriteBooks">
                        <div class="empty-state-mini">
                            <p>Aucun livre 5 Ã©toiles pour le moment</p>
                        </div>
                    </div>
                </div>

                <!-- Livres RÃ©cents -->
                <div class="profile-section-public">
                    <h3 class="section-title-public">ğŸ“š Livres rÃ©cents</h3>
                    <div class="recent-books-grid" id="recentBooks">
                        <div class="empty-state-mini">
                            <p>Aucun livre ajoutÃ© rÃ©cemment</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PAGE 6: PARAMÃˆTRES -->
        <div class="page" id="page-settings" style="display: none;">
            <div class="page-header settings-header">
                <button class="btn-back" id="backToProfileBtn">
                    <span class="back-icon">â†</span>
                    <span class="back-text">Profil</span>
                </button>
                <h1>âš™ï¸ ParamÃ¨tres</h1>
            </div>

            <!-- Tabs ParamÃ¨tres -->
            <div class="settings-tabs">
                <button class="settings-tab active" data-tab="profile-edit">
                    <span class="tab-icon">ğŸ‘¤</span>
                    <span class="tab-label">Profil</span>
                </button>
                <button class="settings-tab" data-tab="account">
                    <span class="tab-icon">âš™ï¸</span>
                    <span class="tab-label">Compte</span>
                </button>
                <button class="settings-tab" data-tab="data">
                    <span class="tab-icon">ğŸ’¾</span>
                    <span class="tab-label">DonnÃ©es</span>
                </button>
            </div>

            <!-- TAB: PROFIL -->
            <div class="settings-tab-content" id="tab-profile-edit" style="display: block;">
                <div class="settings-section">
                    <h3>Personnalisation du profil</h3>
                    
                    <div class="setting-item">
                        <label>
                            <span class="label-icon">ğŸ“š</span>
                            Avatar (Emoji)
                        </label>
                        <div class="emoji-picker-container">
                            <div class="current-emoji" id="currentEmoji">ğŸ“š</div>
                            <div class="emoji-grid">
                                <button class="emoji-option" data-emoji="ğŸ“š">ğŸ“š</button>
                                <button class="emoji-option" data-emoji="ğŸ“–">ğŸ“–</button>
                                <button class="emoji-option" data-emoji="ğŸ“">ğŸ“</button>
                                <button class="emoji-option" data-emoji="ğŸ¤“">ğŸ¤“</button>
                                <button class="emoji-option" data-emoji="ğŸ“">ğŸ“</button>
                                <button class="emoji-option" data-emoji="âœ¨">âœ¨</button>
                                <button class="emoji-option" data-emoji="ğŸŒŸ">ğŸŒŸ</button>
                                <button class="emoji-option" data-emoji="ğŸ’¡">ğŸ’¡</button>
                                <button class="emoji-option" data-emoji="ğŸ¯">ğŸ¯</button>
                                <button class="emoji-option" data-emoji="ğŸš€">ğŸš€</button>
                                <button class="emoji-option" data-emoji="ğŸ¨">ğŸ¨</button>
                                <button class="emoji-option" data-emoji="ğŸŒˆ">ğŸŒˆ</button>
                            </div>
                        </div>
                    </div>

                    <div class="setting-item">
                        <label for="userNameInput">
                            <span class="label-icon">ğŸ‘¤</span>
                            Nom d'utilisateur
                        </label>
                        <input type="text" id="userNameInput" placeholder="Votre nom">
                    </div>

                    <div class="setting-item">
                        <label for="userBio">
                            <span class="label-icon">âœï¸</span>
                            Biographie
                        </label>
                        <textarea id="userBio" placeholder="Parlez-nous de vos goÃ»ts littÃ©raires, vos genres prÃ©fÃ©rÃ©s..." rows="3" maxlength="120"></textarea>
                        <small class="char-counter"><span id="bioCharCount">0</span>/120 caractÃ¨res</small>
                    </div>

                    <button id="saveProfile" class="btn btn-primary btn-save-settings">
                        ğŸ’¾ Enregistrer le profil
                    </button>
                </div>
            </div>

            <!-- TAB: COMPTE -->
            <div class="settings-tab-content" id="tab-account" style="display: none;">
                <div class="settings-section">
                    <h3>PrÃ©fÃ©rences du compte</h3>
                    
                    <div class="setting-item">
                        <label for="yearlyGoal">
                            <span class="label-icon">ğŸ¯</span>
                            Objectif annuel de lecture
                        </label>
                        <div class="goal-input-group">
                            <input type="number" id="yearlyGoal" value="24" min="1" max="365">
                            <span class="goal-suffix">livres / an</span>
                        </div>
                    </div>

                    <button id="saveAccount" class="btn btn-primary btn-save-settings">
                        ğŸ’¾ Enregistrer les prÃ©fÃ©rences
                    </button>

                    <div class="about-section">
                        <p class="version-info">ğŸ“š Ma BibliothÃ¨que v0.6.1.0</p>
                        <p class="version-date">DÃ©cembre 2025 â€¢ Status selector & UX improvements</p>
                    </div>
                </div>
            </div>

            <!-- TAB: DONNÃ‰ES -->
            <div class="settings-tab-content" id="tab-data" style="display: none;">
                <div class="settings-section">
                    <h3>Gestion des donnÃ©es</h3>
                    
                    <div class="data-section">
                        <div class="data-card">
                            <h4>ğŸ“¥ Importer une bibliothÃ¨que</h4>
                            <p>Importer vos livres depuis un fichier JSON</p>
                            <input type="file" id="importFile" accept=".json" style="display: none;">
                            <button class="btn btn-secondary btn-data" id="importBtn">
                                ğŸ“¥ Importer
                            </button>
                        </div>
                        
                        <div class="data-card">
                            <h4>ğŸ“¤ Exporter ma bibliothÃ¨que</h4>
                            <p>TÃ©lÃ©charger toutes vos donnÃ©es en JSON</p>
                            <button class="btn btn-secondary btn-data" id="exportBtn">
                                ğŸ“¤ Exporter
                            </button>
                        </div>
                        
                        <div class="data-card data-card-danger">
                            <h4>ğŸ—‘ï¸ Zone dangereuse</h4>
                            <p>Supprimer dÃ©finitivement toutes vos donnÃ©es</p>
                            <button class="btn btn-danger btn-data" id="clearBtn">
                                ğŸ—‘ï¸ Tout supprimer
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Bottom -->
        <nav class="bottom-nav">
            <button class="nav-item active" data-page="home">
                <span class="nav-icon">ğŸ </span>
                <span class="nav-label">Accueil</span>
            </button>
            
            <button class="nav-item" data-page="search">
                <span class="nav-icon">ğŸ”</span>
                <span class="nav-label">Rechercher</span>
            </button>
            
            <button class="nav-item nav-item-center" data-page="add">
                <span class="nav-icon-large">â•</span>
            </button>
            
            <button class="nav-item" data-page="library">
                <span class="nav-icon">ğŸ“š</span>
                <span class="nav-label">BibliothÃ¨que</span>
            </button>
            
            <button class="nav-item" data-page="profile">
                <span class="nav-icon">ğŸ‘¤</span>
                <span class="nav-label">Profil</span>
            </button>
        </nav>

    </div>

    <!-- Scripts modulaires -->
    <script src="https://cdn.jsdelivr.net/npm/@ericblade/quagga2@1.8.4/dist/quagga.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/api.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/router.js"></script>
    <script src="js/app.js"></script>

</body>
</html>
